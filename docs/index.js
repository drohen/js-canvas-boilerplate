function M(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function T(e,t,n){return n={path:t,exports:{},require:function(o,r){return I(o,r??n.path)}},e(n,n.exports),n.exports}function I(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var E=T(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n;(function(r){r.typeOfFunction="function",r.boolTrue=!0})(n||(n={}));function o(r,i,s){if(!s||typeof s.value!==n.typeOfFunction)throw new TypeError("Only methods can be decorated with @bind. <"+i+"> is not a method!");return{configurable:n.boolTrue,get:function(){var g=s.value.bind(this);return Object.defineProperty(this,i,{value:g,configurable:n.boolTrue,writable:n.boolTrue}),g}}}t.bind=o,t.default=o}),U=M(E),h=U;var y={["space-cadet"]:"hsl(238, 30%, 19%)",["blue-sapphire"]:"hsl(207, 34%, 31%)"};function _(e,t){let n=(t??document).querySelector(e);if(!n)throw Error(`No element ${e}`);return n}function j(e){return{do:t=>{if(e!=null)return t(e)}}}function S(e){return{on:t=>({do:n=>(e.addEventListener(t,n),()=>e.removeEventListener(t,n))})}}function l(e){return e.length>0?e[e.length-1]:void 0}var d=class{next(t){this.subscriber?.next?.(t)}complete(){this.subscriber?.complete?.()}error(t){this.subscriber?.error?.(t)}subscribe(t){this.subscriber=t}};var H=Object.defineProperty,L=Object.getOwnPropertyDescriptor,O=(e,t,n,o)=>{for(var r=o>1?void 0:o?L(t,n):t,i=e.length-1,s;i>=0;i--)(s=e[i])&&(r=(o?s(t,n,r):s(r))||r);return o&&r&&H(t,n,r),r},a;(function(e){e.down="mousedown",e.move="mousemove",e.leave="mouseleave",e.up="mouseup"})(a||(a={}));var p;(function(e){e.start="touchstart",e.move="touchmove",e.cancel="touchcancel",e.end="touchend"})(p||(p={}));var m=class{constructor(){this.onInput=new d}handleMountInput(t){let n=S(t);n.on(a.down).do(o=>{o.preventDefault(),this.onInput.next({type:a.down,data:o})}),n.on(p.start).do(o=>{o.preventDefault(),this.onInput.next({type:p.start,data:o})}),n.on(a.move).do(o=>{o.preventDefault(),this.onInput.next({type:a.move,data:o})}),n.on(p.move).do(o=>{o.preventDefault(),this.onInput.next({type:p.move,data:o})}),n.on(a.leave).do(o=>{o.preventDefault(),this.onInput.next({type:a.leave,data:o})}),n.on(a.up).do(o=>{o.preventDefault(),this.onInput.next({type:a.up,data:o})}),n.on(p.cancel).do(o=>{o.preventDefault(),this.onInput.next({type:p.cancel,data:o})}),n.on(p.end).do(o=>{o.preventDefault(),this.onInput.next({type:p.end,data:o})})}next(t){this.handleMountInput(t)}};O([h],m.prototype,"handleMountInput",1);O([h],m.prototype,"next",1);function x(e,t){return n=>{customElements.define(e,n,t)}}var R=Object.defineProperty,N=Object.getOwnPropertyDescriptor,D=(e,t,n,o)=>{for(var r=o>1?void 0:o?N(t,n):t,i=e.length-1,s;i>=0;i--)(s=e[i])&&(r=(o?s(t,n,r):s(r))||r);return o&&r&&R(t,n,r),r},v=class extends HTMLElement{constructor(t,n){super();this.tag=t,this.onMount=n,this.getMount(),this.isDefined=!1,this.stylesheets=[];let r=this.getTemplate().content;this.attachShadow({mode:"open"}).appendChild(r.cloneNode(!0)),this.registerStylesheet("main.css"),customElements.whenDefined(this.tag).then(()=>{this.isDefined=!0,this.onMount?.(this);for(let i of this.stylesheets)this.setStylesheet(i);this.onDefined()})}getMount(t,n=0){if(this.onMount)return;let o=t||this,r=o instanceof ShadowRoot?o.host:o.parentNode;if(this.hasMount(r)){this.onMount=r.onMount;return}if(n===99||!r)throw Error("No onMount");this.getMount(r,n+=1)}hasMount(t){return t?"onMount"in t:!1}getTemplate(){let t=document.getElementById(this.tag);if(!t)throw Error(`No element ${this.tag}`);if(!(t instanceof HTMLTemplateElement))throw Error("Element is not a template");return t}setStylesheet(t){let n=document.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("href",t),this.shadowRoot?.appendChild(n)}registerStylesheet(t){this.isDefined?this.setStylesheet(t):this.stylesheets.push(t)}onDefined(){}};D([h],v.prototype,"setStylesheet",1);D([h],v.prototype,"registerStylesheet",1);var V=Object.defineProperty,q=Object.getOwnPropertyDescriptor,W=(e,t,n,o)=>{for(var r=o>1?void 0:o?q(t,n):t,i=e.length-1,s;i>=0;i--)(s=e[i])&&(r=(o?s(t,n,r):s(r))||r);return o&&r&&V(t,n,r),r},c=class extends v{constructor(e){super("ui-canvas",e);this.onUpdate=new d,this.previousTime=0}init(){j(this.shadowRoot).do(e=>{this.previousTime=performance.now(),this.render(this.previousTime,this.getCtx(_("canvas",e)))})}getCtx(e){let t=e.getContext("2d");if(!t)throw"No rendering context";return t}render(e,t){let n=e-this.previousTime,o=t.canvas;this.setWH(o),t.fillStyle=y["blue-sapphire"],t.fillRect(0,0,o.width,o.height),this.onUpdate.next({delta:n,ctx:t}),this.previousTime=e,requestAnimationFrame(r=>this.render(r,t))}setWH(e){let{width:t,height:n}=e.getBoundingClientRect();e.width===t&&e.height===n||(e.width=t,e.height=n)}};c=W([x("ui-canvas")],c);var B=Object.defineProperty,F=Object.getOwnPropertyDescriptor,b=(e,t,n,o)=>{for(var r=o>1?void 0:o?F(t,n):t,i=e.length-1,s;i>=0;i--)(s=e[i])&&(r=(o?s(t,n,r):s(r))||r);return o&&r&&B(t,n,r),r},u;(function(e){e.drawing="drawing",e.done="done"})(u||(u={}));var f=class{constructor(){this.time=0,this.lines=[],this.lineState=[],this.mouseType=Object.values(a),this.handleMouse={[a.down]:t=>{(l(this.lineState)===u.done||!this.lineState[0])&&(this.lines.push([this.mouseVector(t)]),this.lineState.push(u.drawing))},[a.move]:t=>{l(this.lineState)===u.drawing&&l(this.lines)?.push(this.mouseVector(t))},[a.leave]:()=>{l(this.lineState)===u.drawing&&(this.lineState[this.lineState.length-1]=u.done)},[a.up]:()=>{l(this.lineState)===u.drawing&&(this.lineState[this.lineState.length-1]=u.done)}},this.handleTouch={[p.start]:t=>{(l(this.lineState)===u.done||!this.lineState[0])&&t.touches[0]&&(this.lines.push([this.touchVector(t)]),this.lineState.push(u.drawing))},[p.move]:t=>{l(this.lineState)===u.drawing&&t.touches[0]&&l(this.lines)?.push(this.touchVector(t))},[p.cancel]:()=>{l(this.lineState)===u.drawing&&(this.lineState[this.lineState.length-1]=u.done)},[p.end]:()=>{l(this.lineState)===u.drawing&&(this.lineState[this.lineState.length-1]=u.done)}}}mouseVector(t){if(!(t.currentTarget instanceof c))return[0,0];let n=t.currentTarget,o=n.getBoundingClientRect();return[(t.clientX-o.x)/n.clientWidth,(t.clientY-o.y)/n.clientHeight]}touchVector(t){if(!(t.currentTarget instanceof c))return[0,0];let n=t.currentTarget,o=n.getBoundingClientRect();return[(t.touches[0].clientX-o.x)/n.clientWidth,(t.touches[0].clientY-o.y)/n.clientHeight]}next(t){"ctx"in t?this.draw(t):this.input(t)}input(t){this.isMouseInputEvent(t)?this.handleMouse[t.type](t.data):this.handleTouch[t.type](t.data)}isMouseInputEvent(t){return this.mouseType.includes(t.type)}draw({ctx:t,delta:n}){this.time+=n,t.lineWidth=4,t.lineCap="round",t.lineJoin="round";let o=3333;for(let r of this.lines){t.beginPath(),t.moveTo(r[0][0]*t.canvas.width,r[0][1]*t.canvas.height);for(let i of r.slice(1))t.lineTo(i[0]*t.canvas.width,i[1]*t.canvas.height);t.strokeStyle=`hsl(${Math.abs(Math.cos((this.time+o)*(1e-7*(o%1e4))))*360}, 49%, 47%)`,t.stroke(),t.closePath(),o+=3333}}};b([h],f.prototype,"next",1);b([h],f.prototype,"input",1);b([h],f.prototype,"isMouseInputEvent",1);b([h],f.prototype,"draw",1);var A=Object.defineProperty,$=Object.getOwnPropertyDescriptor,X=(e,t,n,o)=>{for(var r=o>1?void 0:o?$(t,n):t,i=e.length-1,s;i>=0;i--)(s=e[i])&&(r=(o?s(t,n,r):s(r))||r);return o&&r&&A(t,n,r),r},w=class extends d{constructor(){super()}loadComponent(t){this.isUIComponent(t)&&this.next(t)}isUIComponent(t){return!![c].find(r=>t instanceof r)}load(){let t=document.createElement("main"),n=new c(this.loadComponent);t.appendChild(n),document.body.appendChild(t)}};X([h],w.prototype,"loadComponent",1);var Y=Object.defineProperty,J=Object.getOwnPropertyDescriptor,z=(e,t,n,o)=>{for(var r=o>1?void 0:o?J(t,n):t,i=e.length-1,s;i>=0;i--)(s=e[i])&&(r=(o?s(t,n,r):s(r))||r);return o&&r&&Y(t,n,r),r},P=class{static run(){new P}constructor(){this.components=[],this.render=new f,this.input=new m,this.input.onInput.subscribe(this.render),this.uiLoader=new w,this.uiLoader.subscribe(this),this.uiLoader.load()}next(e){this.components.push(e),e instanceof c&&(e.init(),this.input.next(e),e.onUpdate.subscribe(this.render))}},C=P;z([h],C.prototype,"next",1);C.run();
/*
 web-component-decorator 1.1.0
 @copyright 2020 Edwin Martin
 @license MIT
 */
